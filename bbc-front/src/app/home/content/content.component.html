<div class="page-wrapper">

  <!-- Enhanced Category Menu Section -->
  <section class="category-section" *ngIf="!loading">
    <div class="container">
      <div class="category-menu-enhanced">


        <!-- Category Navigation -->
        <div class="category-navigation">
          <div class="category-scroll-wrapper">


            <div class="category-scroll-container" #categoryContainer>
              <!-- All Products Button -->
              <button
                class="category-btn-simple"
                (click)="onCategorySelect(null)"
              >
                <div class="category-icon">
                  <i class="bi bi-grid-3x3-gap-fill"></i>
                </div>
                <span class="category-text">All Products</span>
              </button>

              <!-- Category Items -->
              <button
                *ngFor="let category of categories"
                class="category-btn-simple"
                (click)="onCategorySelect(category.id)"
              >
                <div class="category-icon">
                  <i class="bi bi-tag-fill"></i>
                </div>
                <span class="category-text">{{ category.title }}</span>
              </button>
            </div>

            <button class="scroll-btn scroll-right" (click)="scrollCategories('right')" *ngIf="showScrollButtons">
              <i class="bi bi-chevron-right"></i>
            </button>
          </div>
        </div>


      </div>
    </div>
  </section>

  <section class="mt-2">
    <div id="carouselExampleCaptions" class="carousel slide">
      <div class="carousel-indicators">
        <button
          type="button"
          data-bs-target="#carouselExampleCaptions"
          data-bs-slide-to="0"
          class="active"
          aria-current="true"
          aria-label="Slide 1"
        ></button>
        <button
          type="button"
          data-bs-target="#carouselExampleCaptions"
          data-bs-slide-to="1"
          aria-label="Slide 2"
        ></button>
        <button
          type="button"
          data-bs-target="#carouselExampleCaptions"
          data-bs-slide-to="2"
          aria-label="Slide 3"
        ></button>
      </div>
      <div class="carousel-inner">
        <div class="carousel-item">
          <img
            src="../../../assets/images/slides/slide1.jpg"
            class="d-block w-100"
            style="height: 420px"
            alt="Product showcase slide 1"
          />
        </div>
        <div class="carousel-item active">
          <img
            src="../../../assets/images/slides/slide2.jpg"
            class="d-block w-100"
            style="height: 420px"
            alt="Product showcase slide 2"
          />
        </div>
        <div class="carousel-item">
          <img
            src="../../../assets/images/slides/slide3.jpg"
            class="d-block w-100"
            style="height: 420px"
            alt="Product showcase slide 3"
          />
        </div>
      </div>
      <button
        class="carousel-control-prev"
        type="button"
        data-bs-target="#carouselExampleCaptions"
        data-bs-slide="prev"
      >
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button
        class="carousel-control-next"
        type="button"
        data-bs-target="#carouselExampleCaptions"
        data-bs-slide="next"
      >
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  </section>



  <!-- Loading Section -->
  <section class="container" *ngIf="loading">
    <div class="text-center py-5">
      <output class="spinner-border text-primary" aria-live="polite">
        <span class="visually-hidden">Loading...</span>
      </output>
      <p class="mt-2">Loading categories and products...</p>
    </div>
  </section>

  <section class="container">
    <div class="d-flex align-items-center gap-1 mb-4">
      <svg
        class="svg-style"
        focusable="false"
        aria-hidden="true"
        viewBox="0 0 24 24"
      >
        <path
          d="M19.0765 9.48063H12.1242L15.5905 0L5 14.5194H11.9522L8.48592 24L19.0765 9.48063Z"
        ></path>
      </svg>
      <h2 class="fw-bold fs-3 m-0">Recommended</h2>
    </div>
    <div
      class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 row-cols-xl-4 row-cols-xxl-5 product-grid"
      *ngIf="products.length > 0"
    >
      <div
        *ngFor="let p of products"
        class="col cursor-pointer"
        (click)="showProduct(p.id)"
        (keydown.enter)="showProduct(p.id)"
        (keydown.space)="showProduct(p.id)"
        [attr.aria-label]="'View details for ' + p.title"
      >
        <div class="card">
          <img
            src="{{ host + getFirstImage(p) }}"
            class="card-img-top"
            alt="..."
          />
          <div class="">
            <div class="position-absolute top-0 end-0 m-3 product-discount">
              <span class="">{{ getDiscountPercentage(p) }}</span>
            </div>
          </div>
          <div class="card-body">
            <h6 class="card-title cursor-pointer">{{ p.title }}</h6>
            <div class="clearfix">
              <p class="mb-0 float-start"><strong>134</strong> Sales</p>
              <p class="mb-0 float-end fw-bold">
                <span class="me-2 text-decoration-line-through text-secondary"
                  >{{ p.regularPrice }} TND</span
                ><span>{{ p.salePrice }}TND</span>
              </p>
            </div>
            <div class="d-flex align-items-center mt-3 fs-6">
              <div class="cursor-pointer">
                <i class="bx bxs-star text-warning"></i>
                <i class="bx bxs-star text-warning"></i>
                <i class="bx bxs-star text-warning"></i>
                <i class="bx bxs-star text-warning"></i>
                <i class="bx bxs-star text-secondary"></i>
              </div>
              <p class="mb-0 ms-auto">4.2(182)</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      *ngIf="products.length === 0"
      class="text-center py-5"
    >
      <h4 class="text-muted">No products found</h4>
      <p class="text-muted">
        Please check back later for new products.
      </p>
    </div>
  </section>
</div>
